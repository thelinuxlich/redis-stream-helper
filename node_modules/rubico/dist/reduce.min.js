/**
 * rubico v1.8.1
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2021 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(n,t){"object"==typeof module?module.exports=t:"function"==typeof define?define((()=>t)):n.reduce=t}("object"==typeof globalThis?globalThis:this,function(){"use strict";const n=n=>null!=n&&"function"==typeof n.then,t=Symbol.for("placeholder"),e=function(n,e,r,o){return e==t?((n,t,e)=>function(r){return n(r,t,e)})(n,r,o):r==t?((n,t,e)=>function(r){return n(t,r,e)})(n,e,o):((n,t,e)=>function(r){return n(t,e,r)})(n,e,r)},r=function(n,e,r,o){return e==t?((n,t,e)=>function(...r){return n(r,t,e)})(n,r,o):r==t?((n,t,e)=>function(...r){return n(t,r,e)})(n,e,o):((n,t,e)=>function(...r){return n(t,e,r)})(n,e,r)},o=Array.isArray,u=(Object.values,Object.prototype.toString),c=n=>u.call(n),i=async function(t,e,r){let o=t.next();if(o.done)return r;for(;!o.done;)r=e(r,o.value),n(r)&&(r=await r),o=t.next();return r},f=function(r,o,u){let c=r.next();if(c.done)return u;for(void 0===u&&(u=c.value,c=r.next());!c.done;){if(u=o(u,c.value),n(u))return u.then(e(i,r,o,t));c=r.next()}return u},a=async function(n,t,e){let r=await n.next();if(r.done)return e;for(void 0===e&&(e=r.value,r=await n.next());!r.done;)e=await t(e,r.value),r=await n.next();return e},l=Symbol.iterator,s=Symbol.asyncIterator,y=function(n,e,r){return e==t?((n,t)=>function(e){return n(e,t)})(n,r):((n,t)=>function(e){return n(t,e)})(n,e)},d=function(n,e,r,o,u){return e==t?((n,t,e,r)=>function(o){return n(o,t,e,r)})(n,r,o,u):r==t?((n,t,e,r)=>function(o){return n(t,o,e,r)})(n,e,o,u):o==t?((n,t,e,r)=>function(o){return n(t,e,o,r)})(n,e,r,u):((n,t,e,r)=>function(o){return n(t,e,r,o)})(n,e,r,o)},h=async function(t,e,r,o){const u=t.length;for(;++o<u;)r=e(r,t[o],o,t),n(r)&&(r=await r);return r},p=Object.keys,v=async function(t,e,r,o,u){const c=o.length;for(;++u<c;){const c=o[u];r=e(r,t[c],c,t),n(r)&&(r=await r)}return r},b=async function(t,e,r,o){for(const[u,c]of o)r=e(r,c,u,t),n(r)&&(r=await r);return r},x=(n,t)=>function(...e){return t(n(...e))},g=(e,r)=>function(o,u){const c=e(o,u);return n(c)?c.then(y(r,t,u)):r(c,u)},j=function(u,i,w){const m=u[0];return o(m)?function(e,r,o){const u=e.length;let c=-1;for(void 0===o&&(o=e[++c]);++c<u;)if(o=r(o,e[c],c,e),n(o))return o.then(d(h,e,r,t,c));return o}(m,i,w):"function"==typeof m?"[object GeneratorFunction]"==c(m)?((n,r,o)=>x(n,e(f,t,r,o)))(m,i,w):(n=>"[object AsyncGeneratorFunction]"==c(n))(m)?((n,r,o)=>x(n,e(a,t,r,o)))(m,i,w):r(j,t,1==u.length?g(i,m):u.reduce(g,i),w):null==m?void 0===w?y(i,m,t):i(w,m):m.constructor==Map?function(e,r,o){const u=e.entries();if(void 0===o){const n=u.next();if(n.done)return o;o=n.value[1]}for(const[c,i]of u)if(o=r(o,i,c,e),n(o))return o.then(d(b,e,r,t,u));return o}(m,i,w):"function"==typeof m[l]?f(m[l](),i,w):"function"==typeof m[s]?a(m[s](),i,w):"function"==typeof m.reduce?m.reduce(i,w):"function"==typeof m.chain?m.chain(y(i,w,t)):"function"==typeof m.flatMap?m.flatMap(y(i,w,t)):m.constructor==Object?function(e,r,o){const u=p(e),c=u.length;let i=-1;for(void 0===o&&(o=e[u[++i]]);++i<c;){const c=u[i];if(o=r(o,e[c],c,e),n(o))return o.then((f=v,l=r,s=t,y=u,d=i,(a=e)==t?((n,t,e,r,o)=>function(u){return n(u,t,e,r,o)})(f,l,s,y,d):l==t?((n,t,e,r,o)=>function(u){return n(t,u,e,r,o)})(f,a,s,y,d):s==t?((n,t,e,r,o)=>function(u){return n(t,e,u,r,o)})(f,a,l,y,d):y==t?((n,t,e,r,o)=>function(u){return n(t,e,r,u,o)})(f,a,l,s,d):((n,t,e,r,o)=>function(u){return n(t,e,r,o,u)})(f,a,l,s,y)))}var f,a,l,s,y,d;return o}(m,i,w):void 0===w?y(i,m,t):i(w,m)};return function(o,u){return"function"==typeof u?function(...r){const c=u(...r);return n(c)?c.then(e(j,r,o,t)):j(r,o,c)}:r(j,t,o,u)}}());
