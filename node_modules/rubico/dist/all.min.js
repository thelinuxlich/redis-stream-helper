/**
 * rubico v1.8.1
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2021 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(e,n){"object"==typeof module?module.exports=n:"function"==typeof define?define((()=>n)):e.all=n}("object"==typeof globalThis?globalThis:this,function(){"use strict";const e=Array.isArray,n=Symbol.for("placeholder"),t=function(e,t,o,r){return t==n?((e,n,t)=>function(o){return e(o,n,t)})(e,o,r):o==n?((e,n,t)=>function(o){return e(n,o,t)})(e,t,r):((e,n,t)=>function(o){return e(n,t,o)})(e,t,o)},o=e=>null!=e&&"function"==typeof e.then,r=Promise.all.bind(Promise),i=(e,n,t)=>e[n](t),u=function(e,u){const f=e.length,c=[];let l=-1;for(;++l<f;){const n=u(e[l]);if(o(n))c.push(n);else if(!n)return!1}return 0==c.length||r(c).then(t(i,n,"every",Boolean))},f=function(e){const n=e.then((e=>[e,n]));return n},c=Promise.race.bind(Promise),l=Object.values,s=(e,n,t)=>!!n&&e(t),a=Symbol.iterator,y=Symbol.asyncIterator;return d=>function(h){return e(h)?u(h,d):null==h?d(h):"function"==typeof h[a]?function(e,u){const f=[];for(const n of e){const e=u(n);if(o(e))f.push(e);else if(!e)return!1}return 0==f.length||r(f).then(t(i,n,"every",Boolean))}(h[a](),d):"function"==typeof h[y]?async function(e,n,t,r=20){let i=await e.next();for(;!i.done;){if(t.size>=r){const[e,n]=await c(t);if(t.delete(n),!e)return!1}const u=n(i.value);if(o(u))t.add(f(u));else if(!u)return!1;i=await e.next()}for(;t.size>0;){const[e,n]=await c(t);if(t.delete(n),!e)return!1}return!0}(h[y](),d,new Set):"function"==typeof h.reduce?h.reduce((e=>function(r,i){return!1!==r&&(o(r)?r.then(t(s,e,n,i)):!!r&&e(i))})(d),!0):h.constructor==Object?u(l(h),d):d(h)}}());
