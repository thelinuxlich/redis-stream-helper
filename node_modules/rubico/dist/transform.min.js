/**
 * rubico v1.8.1
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2021 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(n,t){"object"==typeof module?module.exports=t:"function"==typeof define?define((()=>t)):n.transform=t}("object"==typeof globalThis?globalThis:this,function(){"use strict";const n=n=>null!=n&&"function"==typeof n.then,t=Symbol.for("placeholder"),r=function(n,r,e,o){return r==t?((n,t,r)=>function(e){return n(e,t,r)})(n,e,o):e==t?((n,t,r)=>function(e){return n(t,e,r)})(n,r,o):((n,t,r)=>function(e){return n(t,r,e)})(n,r,e)},e=Array.isArray,o=ArrayBuffer.isView,u=function(n,r,e){return r==t?((n,t)=>function(r){return n(r,t)})(n,e):((n,t)=>function(r){return n(t,r)})(n,r)},c=function(){},f=(n,t)=>n+t,i=(Object.values,Object.prototype.toString),a=n=>i.call(n),l=async function(t,r,e){let o=t.next();if(o.done)return e;for(;!o.done;)e=r(e,o.value),n(e)&&(e=await e),o=t.next();return e},s=function(e,o,u){let c=e.next();if(c.done)return u;for(void 0===u&&(u=c.value,c=e.next());!c.done;){if(u=o(u,c.value),n(u))return u.then(r(l,e,o,t));c=e.next()}return u},y=async function(n,t,r){let e=await n.next();if(e.done)return r;for(void 0===r&&(r=e.value,e=await n.next());!e.done;)r=await t(r,e.value),e=await n.next();return r},d=Symbol.iterator,h=Symbol.asyncIterator,p=function(n,r,e,o,u){return r==t?((n,t,r,e)=>function(o){return n(o,t,r,e)})(n,e,o,u):e==t?((n,t,r,e)=>function(o){return n(t,o,r,e)})(n,r,o,u):o==t?((n,t,r,e)=>function(o){return n(t,r,o,e)})(n,r,e,u):((n,t,r,e)=>function(o){return n(t,r,e,o)})(n,r,e,o)},v=async function(t,r,e,o){const u=t.length;for(;++o<u;)e=r(e,t[o],o,t),n(e)&&(e=await e);return e},g=Object.keys,b=async function(t,r,e,o,u){const c=o.length;for(;++u<c;){const c=o[u];e=r(e,t[c],c,t),n(e)&&(e=await e)}return e},w=async function(t,r,e,o){for(const[u,c]of o)e=r(e,c,u,t),n(e)&&(e=await e);return e},j=(n,t)=>function(...r){return t(n(...r))},x=(r,e)=>function(o,c){const f=r(o,c);return n(f)?f.then(u(e,t,c)):e(f,c)},m=function(o,c,f){const i=o[0];return e(i)?function(r,e,o){const u=r.length;let c=-1;for(void 0===o&&(o=r[++c]);++c<u;)if(o=e(o,r[c],c,r),n(o))return o.then(p(v,r,e,t,c));return o}(i,c,f):"function"==typeof i?"[object GeneratorFunction]"==a(i)?((n,e,o)=>j(n,r(s,t,e,o)))(i,c,f):(n=>"[object AsyncGeneratorFunction]"==a(n))(i)?((n,e,o)=>j(n,r(y,t,e,o)))(i,c,f):(l=m,S=t,O=1==o.length?x(c,i):o.reduce(x,c),A=f,S==t?((n,t,r)=>function(...e){return n(e,t,r)})(l,O,A):O==t?((n,t,r)=>function(...e){return n(t,e,r)})(l,S,A):((n,t,r)=>function(...e){return n(t,r,e)})(l,S,O)):null==i?void 0===f?u(c,i,t):c(f,i):i.constructor==Map?function(r,e,o){const u=r.entries();if(void 0===o){const n=u.next();if(n.done)return o;o=n.value[1]}for(const[c,f]of u)if(o=e(o,f,c,r),n(o))return o.then(p(w,r,e,t,u));return o}(i,c,f):"function"==typeof i[d]?s(i[d](),c,f):"function"==typeof i[h]?y(i[h](),c,f):"function"==typeof i.reduce?i.reduce(c,f):"function"==typeof i.chain?i.chain(u(c,f,t)):"function"==typeof i.flatMap?i.flatMap(u(c,f,t)):i.constructor==Object?function(r,e,o){const u=g(r),c=u.length;let f=-1;for(void 0===o&&(o=r[u[++f]]);++f<c;){const c=u[f];if(o=e(o,r[c],c,r),n(o))return o.then((i=b,l=e,s=t,y=u,d=f,(a=r)==t?((n,t,r,e,o)=>function(u){return n(u,t,r,e,o)})(i,l,s,y,d):l==t?((n,t,r,e,o)=>function(u){return n(t,u,r,e,o)})(i,a,s,y,d):s==t?((n,t,r,e,o)=>function(u){return n(t,r,u,e,o)})(i,a,l,y,d):y==t?((n,t,r,e,o)=>function(u){return n(t,r,e,u,o)})(i,a,l,s,d):((n,t,r,e,o)=>function(u){return n(t,r,e,o,u)})(i,a,l,s,y)))}var i,a,l,s,y,d;return o}(i,c,f):void 0===f?u(c,i,t):c(f,i);var l,S,O,A},S=Object.assign,O=function(n,t){return null!=(r=t)&&r.length>0?function(n,t){const r=n.length,e=t.length;let o=-1;for(;++o<e;)n[r+o]=t[o];return n}(n,t):(n.push(t),n);var r},A="function"==typeof Buffer,B=A?Buffer.alloc:c,M=function(n,t){const r=n.length,e=A&&n.constructor==Buffer?B(r+t.length):new n.constructor(r+t.length);return e.set(n),e.set(t,r),e},F=function(n,t){return e(t)||o(t)?M(n,t):M(n,[t])},G=function(n,t){return null!=(r=t)&&"function"==typeof r.pipe?((n,t)=>new Promise(((n,t)=>function(r,e){var o,u;t.on("data",(n=>function(t,r,e){return n.write(t,r,e),n})(n)),t.on("end",(o=r,u=n,function(){return o(u)})),t.on("error",e)})(n,t)))(n,t):(n.write(t),n);var r},T=function(n,t){if(null!=t&&t.constructor==Set){for(const r of t)n.add(r);return n}return n.add(t)},k=function(n,t){return n.concat(t)},I=function(t,r,e){const o=m(t,r(c),null);return n(o)?o.then((u=e,function(){return u})):e;var u},P=function(r,c,i){if(e(i))return m(r,c(O),i);if(o(i)){const e=m(r,c(O),[]);return n(e)?e.then(u(F,i,t)):F(i,e)}if(null==i)return I(r,c,i);const a=i.constructor;return"string"==typeof i||a==String?m(r,c(f),i):"function"==typeof i.concat?m(r,c(k),i):"function"==typeof i.write?m(r,c(G),i):a==Set?m(r,c(T),i):a==Object?m(r,c(S),i):I(r,c,i)};return function(e,o){return"function"==typeof o?function(...u){const c=o(...u);return n(c)?c.then(r(P,u,e,t)):P(u,e,c)}:function(...n){return P(n,e,o)}}}());
